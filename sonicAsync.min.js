(function(g){function l(){}function p(c,a){g.silent||console.error("callback called already; err=",c,"; data=",a);if(g.trace)console.trace("callback called already stack");else if(g.errout)throw Error("callback called already");}function r(){throw Error("limit not specified or too big");}g.fastWaterfall=function(c,a){function b(d,e){f+=1;var k=c[f];d?a(d):k?k(e,b):a(d,e)}a=a||l;var f=0;c[0](null,b)};g.waterfall=function(c,a){a=a||l;var b=function(f){return function(d,e){var k=f;if(k){var h=c[k];d?
a(d):h?(h(e,b(k+1)),f=null):a(d,e)}else p(d,e)}};c[0](null,b(1))};g.series=function(c,a){g.parallelLimit(c,1,a)};g.filterSeries=function(c,a,b){function f(h){var m;a(c[h],function(a,g){m?p(a,g):(m=1,a?b(a,e):(g&&(e[k]=c[h],k+=1),h+=1,h<d?f(h):b(a,e)))})}b=b||l;var d=c.length,e=[],k=0;f(0)};g.mapSeries=function(c,a,b){function f(k){var h;a(c[k],function(a,c){h?p(a,c):(h=1,a?b(a,e):(e[k]=c,k+=1,k<d?f(k):b(a,e)))})}b=b||l;var d=c.length,e=[];f(0)};g.filter=function(c,a,b){g.filterParallel(c,a,b)};g.filterParallel=
function(c,a,b){function f(d){var f;a(c[d],function(a,g){if(f)p(a,g);else if(f=1,a?k=0:(g&&(e[d]=c[d]),k-=1),!k&&!h)if(h=1,a)b(a,e);else{for(var l=[],v=e.length,t=0,q=0;q<v;q+=1)e[q]&&(l[t]=e[q],t+=1);b(a,l)}})}b=b||l;for(var d=c.length,e=Array(d),k=d,h=0;d;)d-=1,f(d)};g.filter=g.filterParallel;g.mapParallel=function(c,a,b){function f(d){var f;a(c[d],function(a,c){f?p(a,c):(f=1,a)?h||(h=1,b(a,e)):(e[d]=c,k-=1,k||h||(h=1,b(a,e)))})}b=b||l;for(var d=c.length,e=Array(d),k=d,h=0;d;)d-=1,f(d)};g.mapAll=
function(c,a,b){function f(d){a(c[d],function(a,c){null===d?p(a,c):(e[d]=a?a:c,k-=1,d=null,k||(b(a,e),b=l))})}b=b||l;for(var d=c.length,e=Array(d),k=d;d;)d-=1,f(d)};g.map=g.mapParallel;g.mapAllParallel=g.mapAll;g.filterLimit=function(c,a,b,f){function d(b){var l;a(c[b],function(a,v){if(l)p(a,v);else if(l=1,a)g||(g=1,f(a,k));else if(h-=1,v&&(k[b]=c[b]),n<e)g||(h+=1,d(n++));else if(!h&&!g){g=1;for(var t=[],q=0,u=0;u<e;u+=1)k[u]&&(t[q]=k[u],q+=1);f(a,t)}})}f=f||l;var e=c.length;(!b||b>e)&&r();for(var k=
[],h=0,g=0,n=0;n<b;n+=1)h+=1,d(n)};g.mapLimit=function(c,a,b,f){function d(b){var l;a(c[b],function(a,c){l?p(a,c):(l=1,a)?g||(g=1,f(a,k)):(h-=1,k[b]=c,n<e?g||(h+=1,d(n++)):h||g||(g=1,f(a,k)))})}f=f||l;var e=c.length;(!b||b>e)&&r();for(var k=[],h=0,g=0,n=0;n<b;n+=1)h+=1,d(n)};g.parallel=function(c,a){function b(b){return function(c,e){null===b?a!==l&&p(c,e):(c?f=0:(d[b]=e,b=null,f-=1),f||(a(c,d),a=l))}}a=a||l;for(var f=c.length,d=[],e=f;e;)e-=1,c[e](b(e))};g.all=function(c,a){function b(b){return function(c,
e){null===b?a!==l&&p(c,e):(d[b]=c?c:e,b=null,f-=1,f||(a(null,d),a=l))}}a=a||l;for(var f=c.length,d=[],e=f;e;)e-=1,c[e](b(e))};g.race=function(c,a){function b(b,c){b?a(b,null):a(null,c);a=l}a=a||l;for(var f=c.length;f;)f-=1,c[f](b)};g.parallelLimit=function(c,a,b){function f(a){return function(m,r){var s=a;if(null===s)p(m,r);else if(m)b(m,e),b=l;else if(e[s]=r,g+=1,a=null,s=g,s<d)c[s](f(s));else h?h-=1:(b(m,e),b=l)}}(!a||a>d)&&r();b=b||l;for(var d=c.length,e=[],g=a-1,h=g,m=0;m<a;m+=1)c[m](f(m))};g.Noapply=
function(c){var a=[].slice.call(arguments,1);return function(){var b=arguments.length,f;if(0<b){f=[].slice.call(arguments);for(var d=0;d<b;d++)a.push(f[d])}return c.apply(null,a)}};g.trace=0;g.silent=0})(module&&exports?exports:this.sonicAsync=this.sonicAsync||{});
