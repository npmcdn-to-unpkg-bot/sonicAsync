(function(g){function u(d,b,a){var c;d[b](function(e,f){c?n(e,f):(c=1,a[3]-=1,e)?a[5]||(a[5]=1,a[2](e,a[1])):(a[1][b]=f,a[0]+=1,a[0]<a[4]?(a[3]+=1,u(d,a[0],a)):a[3]||a[5]||(a[5]=1,a[2](e,a[1])))})}function l(){}function n(d,b){g.silent||console.error("callback called already; err=",d,"; data=",b);if(g.trace)console.trace("callback called already stack");else if(g.errout)throw Error("callback called already");}function t(){throw Error("limit not specified or too big");}g.fastWaterfall=function(d,b){function a(e,
f){c+=1;var h=d[c];e?b(e):h?h(f,a):b(e,f)}b=b||l;var c=0;d[0](null,a)};g.waterfall=function(d,b){b=b||l;var a=function(c){return function(e,f){var h=c;if(h){var k=d[h];e?b(e):k?(k(f,a(h+1)),c=null):b(e,f)}else n(e,f)}};d[0](null,a(1))};g.series=function(d,b){g.parallelLimit(d,1,b)};g.filterSeries=function(d,b,a){function c(k){var v;b(d[k],function(b,g){v?n(b,g):(v=1,b?a(b,f):(g&&(f[h]=d[k],h+=1),k+=1,k<e?c(k):a(b,f)))})}a=a||l;var e=d.length,f=[],h=0;c(0)};g.mapSeries=function(d,b,a){function c(h){var k;
b(d[h],function(b,d){k?n(b,d):(k=1,b?a(b,f):(f[h]=d,h+=1,h<e?c(h):a(b,f)))})}a=a||l;var e=d.length,f=[];c(0)};g.filter=function(d,b,a){g.filterParallel(d,b,a)};g.filterParallel=function(d,b,a){function c(c){var e;b(d[c],function(b,g){if(e)n(b,g);else if(e=1,b?h=0:(g&&(f[c]=d[c]),h-=1),!h&&!k)if(k=1,b)a(b,f);else{for(var l=[],s=f.length,q=0,p=0;p<s;p+=1)f[p]&&(l[q]=f[p],q+=1);a(b,l)}})}a=a||l;for(var e=d.length,f=Array(e),h=e,k=0;e;)e-=1,c(e)};g.filter=g.filterParallel;g.mapParallel=function(d,b,a){function c(c){var e;
b(d[c],function(b,d){e?n(b,d):(e=1,b)?k||(k=1,a(b,f)):(f[c]=d,h-=1,h||k||(k=1,a(b,f)))})}a=a||l;for(var e=d.length,f=Array(e),h=e,k=0;e;)e-=1,c(e)};g.mapAll=function(d,b,a){function c(c){b(d[c],function(b,e){null===c?n(b,e):(f[c]=b?b:e,h-=1,c=null,h||(a(b,f),a=l))})}a=a||l;for(var e=d.length,f=Array(e),h=e;e;)e-=1,c(e)};g.map=g.mapParallel;g.mapAllParallel=g.mapAll;g.filterLimit=function(d,b,a,c){function e(a){var l;b(d[a],function(b,s){if(l)n(b,s);else if(l=1,b)g||(g=1,c(b,h));else if(k-=1,s&&(h[a]=
d[a]),m<f)g||(k+=1,e(m++));else if(!k&&!g){g=1;for(var q=[],p=0,r=0;r<f;r+=1)h[r]&&(q[p]=h[r],p+=1);c(b,q)}})}c=c||l;var f=d.length;(!a||a>f)&&t();for(var h=[],k=0,g=0,m=0;m<a;m+=1)k+=1,e(m)};g.mapLimit=function(d,b,a,c){function e(a){var l;b(d[a],function(b,d){l?n(b,d):(l=1,b)?g||(g=1,c(b,h)):(k-=1,h[a]=d,m<f?g||(k+=1,e(m++)):k||g||(g=1,c(b,h)))})}c=c||l;var f=d.length;(!a||a>f)&&t();for(var h=[],k=0,g=0,m=0;m<a;m+=1)k+=1,e(m)};g.parallel=function(d,b){function a(a){return function(d,f){null===a?
b!==l&&n(d,f):(d?c=0:(e[a]=f,a=null,c-=1),c||(b(d,e),b=l))}}b=b||l;for(var c=d.length,e=[],f=c;f;)f-=1,d[f](a(f))};g.all=function(d,b){function a(a){return function(d,f){null===a?b!==l&&n(d,f):(e[a]=d?d:f,a=null,c-=1,c||(b(null,e),b=l))}}b=b||l;for(var c=d.length,e=[],f=c;f;)f-=1,d[f](a(f))};g.race=function(d,b){function a(a,c){a?b(a,null):b(null,c);b=l}b=b||l;for(var c=d.length;c;)c-=1,d[c](a)};g.parallelLimit=function(d,b,a){a=a||l;var c=d.length;(!b||b>c)&&t();a=[b-1,[],a,0,c,0];for(c=0;c<b;c+=
1)a[3]+=1,u(d,c,a)};g.Noapply=function(d){var b=[].slice.call(arguments,1);return function(){var a=arguments.length,c;if(0<a){c=[].slice.call(arguments);for(var e=0;e<a;e++)b.push(c[e])}return d.apply(null,b)}};g.trace=0;g.silent=0})(module&&exports?exports:this.sonicAsync=this.sonicAsync||{});
